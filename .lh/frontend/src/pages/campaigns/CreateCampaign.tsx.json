{
    "sourceFile": "frontend/src/pages/campaigns/CreateCampaign.tsx",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 0,
            "patches": [
                {
                    "date": 1767980354297,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                }
            ],
            "date": 1767980354297,
            "name": "Commit-0",
            "content": "import React, { useState } from 'react';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport { ArrowLeft, Save, Eye } from 'lucide-react';\r\nimport { Button, Card, Input, Select } from '../../components/ui';\r\nimport { useCampaignStore } from '../../store/campaignStore';\r\nimport { useAuthStore } from '../../store/authStore';\r\nimport type { Campaign } from '../../types';\r\n\r\nexport const CreateCampaign: React.FC = () => {\r\n  const navigate = useNavigate();\r\n  const { addCampaign } = useCampaignStore();\r\n  const { user } = useAuthStore();\r\n  const [formData, setFormData] = useState({\r\n    campaign_name: '',\r\n    notification_type: '',\r\n    city_filter: '',\r\n  });\r\n\r\n  const cities = ['', 'Delhi', 'Mumbai', 'Bangalore', 'Chennai', 'Kolkata', 'Hyderabad'];\r\n\r\n  const handleSaveDraft = () => {\r\n    const newCampaign: Campaign = {\r\n      campaign_id: `camp-${Date.now()}`,\r\n      campaign_name: formData.campaign_name,\r\n      notification_type: formData.notification_type as any,\r\n      city_filter: formData.city_filter || undefined,\r\n      created_by: user?.user_id || '',\r\n      status: 'draft',\r\n      created_at: new Date().toISOString(),\r\n    };\r\n\r\n    addCampaign(newCampaign);\r\n    navigate('/campaigns');\r\n  };\r\n\r\n  const handlePreview = () => {\r\n    // Store form data temporarily and navigate to preview\r\n    const newCampaign: Campaign = {\r\n      campaign_id: `temp-${Date.now()}`,\r\n      campaign_name: formData.campaign_name,\r\n      notification_type: formData.notification_type as any,\r\n      city_filter: formData.city_filter || undefined,\r\n      created_by: user?.user_id || '',\r\n      status: 'draft',\r\n      created_at: new Date().toISOString(),\r\n    };\r\n\r\n    addCampaign(newCampaign);\r\n    navigate(`/campaigns/${newCampaign.campaign_id}/preview`);\r\n  };\r\n\r\n  const isValid = formData.campaign_name && formData.notification_type;\r\n\r\n  return (\r\n    <div className=\"max-w-3xl mx-auto space-y-6\">\r\n      {/* Header */}\r\n      <div>\r\n        <Button\r\n          variant=\"outline\"\r\n          icon={<ArrowLeft className=\"w-5 h-5\" />}\r\n          onClick={() => navigate('/campaigns')}\r\n          size=\"sm\"\r\n        >\r\n          Back to Campaigns\r\n        </Button>\r\n        <h1 className=\"text-3xl font-bold text-gray-900 mt-4\">Create New Campaign</h1>\r\n        <p className=\"text-gray-600 mt-1\">\r\n          Set up a new notification campaign with targeting criteria\r\n        </p>\r\n      </div>\r\n\r\n      {/* Form */}\r\n      <Card title=\"Campaign Details\">\r\n        <div className=\"p-6 space-y-6\">\r\n          <Input\r\n            label=\"Campaign Name\"\r\n            placeholder=\"e.g., Diwali Offers 2026\"\r\n            value={formData.campaign_name}\r\n            onChange={(e) =>\r\n              setFormData({ ...formData, campaign_name: e.target.value })\r\n            }\r\n            required\r\n          />\r\n\r\n          <Select\r\n            label=\"Notification Type\"\r\n            options={[\r\n              { value: '', label: 'Select notification type' },\r\n              { value: 'offers', label: 'Promotional Offers' },\r\n              { value: 'order_updates', label: 'Order Updates' },\r\n              { value: 'newsletter', label: 'Newsletter' },\r\n            ]}\r\n            value={formData.notification_type}\r\n            onChange={(e) =>\r\n              setFormData({ ...formData, notification_type: e.target.value })\r\n            }\r\n            required\r\n          />\r\n\r\n          <Select\r\n            label=\"Target City (Optional)\"\r\n            options={cities.map((city) => ({\r\n              value: city,\r\n              label: city || 'All Cities',\r\n            }))}\r\n            value={formData.city_filter}\r\n            onChange={(e) =>\r\n              setFormData({ ...formData, city_filter: e.target.value })\r\n            }\r\n          />\r\n\r\n          <div className=\"p-4 bg-blue-50 border border-blue-200 rounded-lg\">\r\n            <h4 className=\"font-medium text-blue-900 mb-2\">Targeting Criteria</h4>\r\n            <ul className=\"text-sm text-blue-800 space-y-1\">\r\n              <li>✓ User must be active</li>\r\n              <li>\r\n                ✓ User must have opted in for{' '}\r\n                <strong>\r\n                  {formData.notification_type\r\n                    ? formData.notification_type.replace('_', ' ')\r\n                    : 'selected notification type'}\r\n                </strong>\r\n              </li>\r\n              {formData.city_filter && (\r\n                <li>\r\n                  ✓ User must be from <strong>{formData.city_filter}</strong>\r\n                </li>\r\n              )}\r\n            </ul>\r\n          </div>\r\n        </div>\r\n      </Card>\r\n\r\n      {/* Actions */}\r\n      <Card>\r\n        <div className=\"p-6 flex items-center justify-between gap-4\">\r\n          <p className=\"text-sm text-gray-600\">\r\n            Save as draft or proceed to preview recipients\r\n          </p>\r\n          <div className=\"flex gap-2\">\r\n            <Button\r\n              variant=\"outline\"\r\n              onClick={handleSaveDraft}\r\n              disabled={!isValid}\r\n              icon={<Save className=\"w-5 h-5\" />}\r\n            >\r\n              Save as Draft\r\n            </Button>\r\n            <Button\r\n              variant=\"primary\"\r\n              onClick={handlePreview}\r\n              disabled={!isValid}\r\n              icon={<Eye className=\"w-5 h-5\" />}\r\n            >\r\n              Preview Recipients\r\n            </Button>\r\n          </div>\r\n        </div>\r\n      </Card>\r\n    </div>\r\n  );\r\n};\r\n"
        }
    ]
}