{
    "sourceFile": "frontend/src/pages/campaigns/CampaignList.tsx",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 0,
            "patches": [
                {
                    "date": 1767980354295,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                }
            ],
            "date": 1767980354295,
            "name": "Commit-0",
            "content": "import React, { useState, useEffect } from 'react';\r\nimport { Plus, Search, Eye, Edit, FileText } from 'lucide-react';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport {\r\n  Button,\r\n  Card,\r\n  Input,\r\n  Table,\r\n  Badge,\r\n  LoadingSpinner,\r\n  Select,\r\n} from '../../components/ui';\r\nimport { useAuthStore } from '../../store/authStore';\r\nimport { useCampaignStore } from '../../store/campaignStore';\r\nimport type { Campaign } from '../../types';\r\n\r\nexport const CampaignList: React.FC = () => {\r\n  const navigate = useNavigate();\r\n  const { hasPermission } = useAuthStore();\r\n  const { campaigns, setCampaigns } = useCampaignStore();\r\n  const [searchQuery, setSearchQuery] = useState('');\r\n  const [statusFilter, setStatusFilter] = useState('');\r\n  const [typeFilter, setTypeFilter] = useState('');\r\n  const [isLoading, setIsLoading] = useState(true);\r\n\r\n  const canCreate = hasPermission('campaigns', 'create');\r\n  const canUpdate = hasPermission('campaigns', 'update');\r\n\r\n  useEffect(() => {\r\n    // Mock data load\r\n    setTimeout(() => {\r\n      const mockCampaigns: Campaign[] = [\r\n        {\r\n          campaign_id: '1',\r\n          campaign_name: 'Diwali Offers 2026',\r\n          notification_type: 'offers',\r\n          city_filter: 'Delhi',\r\n          created_by: 'admin-1',\r\n          status: 'sent',\r\n          created_at: '2026-01-05T10:00:00Z',\r\n          recipient_count: 450,\r\n        },\r\n        {\r\n          campaign_id: '2',\r\n          campaign_name: 'Order Status Updates',\r\n          notification_type: 'order_updates',\r\n          created_by: 'creator-1',\r\n          status: 'sent',\r\n          created_at: '2026-01-06T14:30:00Z',\r\n          recipient_count: 1250,\r\n        },\r\n        {\r\n          campaign_id: '3',\r\n          campaign_name: 'January Newsletter',\r\n          notification_type: 'newsletter',\r\n          city_filter: 'Mumbai',\r\n          created_by: 'creator-1',\r\n          status: 'draft',\r\n          created_at: '2026-01-08T09:15:00Z',\r\n          recipient_count: 0,\r\n        },\r\n        {\r\n          campaign_id: '4',\r\n          campaign_name: 'Flash Sale Bangalore',\r\n          notification_type: 'offers',\r\n          city_filter: 'Bangalore',\r\n          created_by: 'admin-1',\r\n          status: 'draft',\r\n          created_at: '2026-01-09T11:00:00Z',\r\n          recipient_count: 0,\r\n        },\r\n      ];\r\n      setCampaigns(mockCampaigns);\r\n      setIsLoading(false);\r\n    }, 800);\r\n  }, [setCampaigns]);\r\n\r\n  const filteredCampaigns = campaigns.filter((campaign) => {\r\n    const matchesSearch =\r\n      campaign.campaign_name.toLowerCase().includes(searchQuery.toLowerCase()) ||\r\n      campaign.campaign_id.toLowerCase().includes(searchQuery.toLowerCase());\r\n\r\n    const matchesStatus = !statusFilter || campaign.status === statusFilter;\r\n    const matchesType = !typeFilter || campaign.notification_type === typeFilter;\r\n\r\n    return matchesSearch && matchesStatus && matchesType;\r\n  });\r\n\r\n  const getNotificationTypeColor = (type: string) => {\r\n    switch (type) {\r\n      case 'offers':\r\n        return 'badge-warning';\r\n      case 'order_updates':\r\n        return 'badge-info';\r\n      case 'newsletter':\r\n        return 'badge-success';\r\n      default:\r\n        return 'badge-draft';\r\n    }\r\n  };\r\n\r\n  const columns = [\r\n    {\r\n      key: 'campaign_id',\r\n      header: 'Campaign ID',\r\n      render: (campaign: Campaign) => (\r\n        <span className=\"font-mono text-sm text-gray-600\">{campaign.campaign_id}</span>\r\n      ),\r\n    },\r\n    {\r\n      key: 'campaign_name',\r\n      header: 'Campaign Name',\r\n      render: (campaign: Campaign) => (\r\n        <div>\r\n          <div className=\"font-medium text-gray-900\">{campaign.campaign_name}</div>\r\n          <div className=\"text-sm text-gray-500\">\r\n            Created {new Date(campaign.created_at!).toLocaleDateString()}\r\n          </div>\r\n        </div>\r\n      ),\r\n    },\r\n    {\r\n      key: 'notification_type',\r\n      header: 'Type',\r\n      render: (campaign: Campaign) => (\r\n        <Badge className={getNotificationTypeColor(campaign.notification_type)}>\r\n          {campaign.notification_type.replace('_', ' ')}\r\n        </Badge>\r\n      ),\r\n    },\r\n    {\r\n      key: 'city_filter',\r\n      header: 'Target City',\r\n      render: (campaign: Campaign) => (\r\n        <span className=\"text-gray-600\">{campaign.city_filter || 'All Cities'}</span>\r\n      ),\r\n    },\r\n    {\r\n      key: 'status',\r\n      header: 'Status',\r\n      render: (campaign: Campaign) => (\r\n        <Badge variant={campaign.status === 'sent' ? 'success' : 'draft'}>\r\n          {campaign.status}\r\n        </Badge>\r\n      ),\r\n    },\r\n    {\r\n      key: 'recipient_count',\r\n      header: 'Recipients',\r\n      render: (campaign: Campaign) => (\r\n        <span className=\"font-medium text-gray-900\">\r\n          {campaign.recipient_count || '-'}\r\n        </span>\r\n      ),\r\n    },\r\n    {\r\n      key: 'actions',\r\n      header: 'Actions',\r\n      render: (campaign: Campaign) => (\r\n        <div className=\"flex items-center gap-2\">\r\n          <button\r\n            onClick={() => navigate(`/campaigns/${campaign.campaign_id}/preview`)}\r\n            className=\"p-2 text-blue-600 hover:bg-blue-50 rounded-lg transition-colors\"\r\n            title=\"Preview Recipients\"\r\n          >\r\n            <Eye className=\"w-4 h-4\" />\r\n          </button>\r\n          {campaign.status === 'draft' && canUpdate && (\r\n            <button\r\n              onClick={() => navigate(`/campaigns/${campaign.campaign_id}/edit`)}\r\n              className=\"p-2 text-gray-600 hover:bg-gray-50 rounded-lg transition-colors\"\r\n              title=\"Edit Campaign\"\r\n            >\r\n              <Edit className=\"w-4 h-4\" />\r\n            </button>\r\n          )}\r\n          {campaign.status === 'sent' && (\r\n            <button\r\n              onClick={() => navigate(`/logs?campaign=${campaign.campaign_id}`)}\r\n              className=\"p-2 text-green-600 hover:bg-green-50 rounded-lg transition-colors\"\r\n              title=\"View Logs\"\r\n            >\r\n              <FileText className=\"w-4 h-4\" />\r\n            </button>\r\n          )}\r\n        </div>\r\n      ),\r\n      width: '120px',\r\n    },\r\n  ];\r\n\r\n  if (isLoading) {\r\n    return (\r\n      <div className=\"flex items-center justify-center h-96\">\r\n        <LoadingSpinner size=\"lg\" text=\"Loading campaigns...\" />\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      {/* Header */}\r\n      <div className=\"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4\">\r\n        <div>\r\n          <h1 className=\"text-3xl font-bold text-gray-900\">Campaign Management</h1>\r\n          <p className=\"text-gray-600 mt-1\">Create and manage notification campaigns</p>\r\n        </div>\r\n        {canCreate && (\r\n          <Button\r\n            onClick={() => navigate('/campaigns/create')}\r\n            variant=\"primary\"\r\n            icon={<Plus className=\"w-5 h-5\" />}\r\n          >\r\n            Create Campaign\r\n          </Button>\r\n        )}\r\n      </div>\r\n\r\n      {/* Stats */}\r\n      <div className=\"grid grid-cols-1 md:grid-cols-4 gap-6\">\r\n        <Card className=\"p-6\">\r\n          <div className=\"text-sm text-gray-600 mb-1\">Total Campaigns</div>\r\n          <div className=\"text-3xl font-bold text-gray-900\">{campaigns.length}</div>\r\n        </Card>\r\n        <Card className=\"p-6\">\r\n          <div className=\"text-sm text-gray-600 mb-1\">Sent</div>\r\n          <div className=\"text-3xl font-bold text-green-600\">\r\n            {campaigns.filter((c) => c.status === 'sent').length}\r\n          </div>\r\n        </Card>\r\n        <Card className=\"p-6\">\r\n          <div className=\"text-sm text-gray-600 mb-1\">Drafts</div>\r\n          <div className=\"text-3xl font-bold text-gray-600\">\r\n            {campaigns.filter((c) => c.status === 'draft').length}\r\n          </div>\r\n        </Card>\r\n        <Card className=\"p-6\">\r\n          <div className=\"text-sm text-gray-600 mb-1\">Total Recipients</div>\r\n          <div className=\"text-3xl font-bold text-primary-600\">\r\n            {campaigns.reduce((sum, c) => sum + (c.recipient_count || 0), 0)}\r\n          </div>\r\n        </Card>\r\n      </div>\r\n\r\n      {/* Filters */}\r\n      <Card>\r\n        <div className=\"p-6\">\r\n          <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\r\n            <div className=\"md:col-span-1\">\r\n              <Input\r\n                placeholder=\"Search campaigns...\"\r\n                icon={<Search className=\"w-5 h-5\" />}\r\n                value={searchQuery}\r\n                onChange={(e) => setSearchQuery(e.target.value)}\r\n              />\r\n            </div>\r\n            <Select\r\n              options={[\r\n                { value: '', label: 'All Status' },\r\n                { value: 'draft', label: 'Draft' },\r\n                { value: 'sent', label: 'Sent' },\r\n              ]}\r\n              value={statusFilter}\r\n              onChange={(e) => setStatusFilter(e.target.value)}\r\n            />\r\n            <Select\r\n              options={[\r\n                { value: '', label: 'All Types' },\r\n                { value: 'offers', label: 'Offers' },\r\n                { value: 'order_updates', label: 'Order Updates' },\r\n                { value: 'newsletter', label: 'Newsletter' },\r\n              ]}\r\n              value={typeFilter}\r\n              onChange={(e) => setTypeFilter(e.target.value)}\r\n            />\r\n          </div>\r\n        </div>\r\n      </Card>\r\n\r\n      {/* Campaigns Table */}\r\n      <Card>\r\n        <Table\r\n          data={filteredCampaigns}\r\n          columns={columns}\r\n          emptyMessage=\"No campaigns found\"\r\n        />\r\n      </Card>\r\n    </div>\r\n  );\r\n};\r\n"
        }
    ]
}